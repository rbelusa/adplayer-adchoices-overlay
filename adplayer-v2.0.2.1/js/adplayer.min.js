/*
   -------------------------------------------------------------------------------------------
   AdPlayer v2.0.2.FINAL (FINAL.101512)
   Authors: christopher.sancho@adtech.com
            felix.ritter@adtech.com
            ingrid.graefen@sevenonemedia.de
            marius.naumann@bauermedia.com
            anton.parsons@adition.com
            andreas.berenz@adition.com
            o.wagner@raumobil.de
            
   -------------------------------------------------------------------------------------------
  
   This file is part of AdPlayer v2.0.2.FINAL (FINAL.101512).
   AdPlayer is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.
 
   AdPlayer is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
 
   You should have received a copy of the GNU General Public License
   along with AdPlayer.  If not, see <http://www.gnu.org/licenses/>.
  
  --------------------------------------------------------------------------------------------
*/
if(!window.$ADP){$ADP={}}$ADP.Registry=$ADP.Registry||{data:{},translationFile:false,wait:2000,LAST:"LAST",MAIN:"MAIN",POPUP:"POPUP",FRIENDLY_IFRAME:"FRIENDLY_IFRAME",FOREIGN_IFRAME:"FOREIGN_IFRAME",POSTMESSAGE_SEARCH:"POSTMESSAGE_SEARCH",publisherInfo:undefined,register:function(b,a){this._register(b,a,false)},_register:function(e,c,b){if(!c){c={}}if(!this.data[e]){this.data[e]={items:[]}}var d={};for(var a in c){switch(a){case"domId":this.data[e][a]=c[a];break;case"header":case"footer":case"title":case"text":case"url":case"linkText":case"usePopup":case"renderCloseButton":d[a]=c[a];break;default:break}}if(!b){this.data[e].items.push(d)}else{this.data[e].items.unshift(d)}$ADP.Util.log('Registered item with title "'+c.title+'" for ID '+e)},unregister:function(a){if(!this.data[a]){return}delete this.data[a]},getById:function(b){var a=[];if(this.data[b]){a=this.data[b].items||[]}return a},pullById:function(b){var a=this.getById(b);this.unregister(b);return a},getDOMId:function(a){if(this.data[a]){return this.data[a].domId}},hasId:function(a){return this.data[a]?true:false},setPublisherInfo:function(a){if(typeof this.publisherInfo==="undefined"){this.publisherInfo=a}},checkParentAccess:function(c){var b;var a=function(g){try{return Boolean(g.$ADP)}catch(f){return false}};try{if(c.parent.location.href==undefined){b=this.FOREIGN_IFRAME}else{if(a(c.parent)){b=this.FRIENDLY_IFRAME}else{b=this.POSTMESSAGE_SEARCH}}}catch(d){b=this.FOREIGN_IFRAME}return b},getWindowChain:function(f){if(!this.data[f].windowChain){var e=this.checkParentAccess(window.parent);var c={1:{type:e,window:window,parent:window.parent}};if(window!=window.parent){var d=true;var b=2;var a=window.parent;var e;while(d){if(a==a.parent){e=this.checkParentAccess(a.parent);c[b]={type:e,window:a};d=false}else{e=this.checkParentAccess(a.parent);c[b]={type:e,window:a,parent:a.parent};a=a.parent}b++}if(window.opener){e=this.checkParentAccess(window.opener);c[b]={type:e,window:window,parent:window.opener}}}else{if(window.opener){e=this.checkParentAccess(window.opener);c[2]={type:e,window:window,parent:window.opener}}}this.data[f].windowChain=c}return this.data[f].windowChain},checkAndReducePostMessageCounter:function(a){this.data[a].postMessageCounter--;if(this.data[a].postMessageCounter==0){clearTimeout(this.data[a].postMessageTimeout);this.submitPrivacy(a)}},registerParentItems:function(c,b){if(!b){b=[]}if(!this.data[c]){return}if(this.data[c].iframeSearch&&this.data[c].iframeSearch.timeoutId){clearTimeout(this.data[c].iframeSearch.timeoutId)}b.reverse();for(var a in b){$ADP.Registry._register(c,b[a],true)}},createPlayer:function(a,g){$ADP.Util.log("$ADP.Registry.createPlayer called for ID "+a);if(!g){g={}}var e=g.header||undefined;var i=g.footer||undefined;var h=this.publisherInfo||"";var c=g.domId;var f=g.position||"top-right";var b=g.usePopup||true;var d=g.renderCloseButton==false?false:true;if(!this.data[a]){this.data[a]={domId:null,items:[]}}if(c){this.data[a].domId=c}c=this.getDOMId(a);var j=$ADP.Player(a,{domId:c,position:f,header:e,footer:i,publisherInfo:h,usePopup:b,renderCloseButton:d});j.inject();this.data[a].player=j;$ADP.Util.log("AdPlayer created for ID "+a);return j},generateId:function(){var a;do{a=parseInt(Math.random()*100000000)}while(this.hasId(a));$ADP.Util.log("Adplayer generated ID "+a);return a},messageHandler:function(b){try{var f=$ADP.Message.parse(b.data),d=b.source,a="";if(d==window){return null}switch(f.type){case $ADP.Message.types.pullOBA:a=$ADP.Registry.getById(f.data);$ADP.Message.send(d,$ADP.Message.types.pullOBA_ACK,{id:f.data,items:a});break;case $ADP.Message.types.unRegOBA:a=$ADP.Registry.unregister(f.data);break;case $ADP.Message.types.pullOBA_ACK:if(f.data.id&&f.data.items&&f.data.items.length){$ADP.Registry.registerParentItems(f.data.id,f.data.items);$ADP.Message.send(d,$ADP.Message.types.unRegOBA,f.data.id);$ADP.Registry.checkAndReducePostMessageCounter(f.data.id)}break}}catch(c){$ADP.Util.log("Received Message",b," Rejected ",c)}},getItems:function(e){var b=this.data[e].items;var a=[];for(var d=0;d<b.length;d++){if(b[d].usePopup==false){this.data[e].player.usePopup=false}if(b[d].renderCloseButton==false){this.data[e].player.renderCloseButton=false}var c=$ADP.PrivacyInfo(b[d]);if(c.isValid()){a.push(c)}}return a},collectPrivacy:function(b){var c=true;if(this.data[b].items&&this.data[b].items.length){for(var f in this.data[b].items){if(this.data[b].items[f].usePopup==false){c=false}}}if(c){if(this.data[b].player.popup){this.data[b].player.popup.close()}try{var g="adp_info_"+Math.floor(Math.random()*100001);popwin=window.open("",g,"width=400,height=500,scrollbars=yes,location=0,menubar=0,toolbar=0,status=0")}catch(h){popwin=window.open("about:blank")}this.data[b].player.popup=popwin}if(this.data[b].player.items&&this.data[b].player.items.length){this.submitPrivacy(b)}else{var a=this.getWindowChain(b);var l=[];for(var d in a){var j;if(!a[d].parent||a[d].parent==window){}else{if(a[d].type==this.FOREIGN_IFRAME||a[d].type==this.POSTMESSAGE_SEARCH){l.push(a[d])}else{if(a[d].window&&a[d].window.name){try{j=$ADP.Util.JSON.parse($ADP.Util.atob(a[d].window.name.replace(/^[^-]+\-([A-Za-z0-9\+\/]+=?=?=?)$/,"$1")))}catch(h){}}if(!j){try{j=a[d].parent.$ADP.Registry.getById(b)}catch(h){}}if(j.length){$ADP.Registry.registerParentItems(b,j)}}}}if(l&&l.length){if(window.postMessage){this.initByPostMessage(b,l)}else{this.initByWindowName(b,l)}}else{this.submitPrivacy(b)}}},initByPostMessage:function(b,a){for(k in a){if(this.data[b].postMessageCounter){this.data[b].postMessageCounter++}else{this.data[b].postMessageCounter=1}$ADP.Message.send(a[k].parent,$ADP.Message.types.pullOBA,b)}this.data[b].postMessageTimeout=setTimeout(function(){$ADP.Registry.submitPrivacy(b)},1000)},initByWindowName:function(d,b){for(k in b){if(!b[k].window.name){return}try{var a=$ADP.Util.JSON.parse($ADP.Util.atob(b[k].window.name.replace(/^[^-]+\-([A-Za-z0-9\+\/]+=?=?=?)$/,"$1")));if(a.length){this.registerParentItems(d,a)}}catch(c){}}this.submitPrivacy(d)},submitPrivacy:function(a){if(!this.data[a]&&!this.data[a].player){return}if(!this.data[a].player.items||this.data[a].player.items.length){this.data[a].player.items=this.getItems(a)}this.data[a].player.showPrivacy.apply(this.data[a].player,[])},playerCmd:function(c,b,a){if(!b){return}if(!this.data[c]&&!this.data[c].player){return}if(!a){a=[]}this.data[c].player.items=this.getItems(c);if(typeof this.data[c].player[b]=="function"){this.data[c].player[b].apply(this.data[c].player,a)}},setTranslation:function(a){if(!this.translationFile&&a.href){this.translationFile=a.href}},init:function(){if(window.addEventListener){window.addEventListener("message",$ADP.Registry.messageHandler,false)}else{if(window.attachEvent){window.attachEvent("onmessage",$ADP.Registry.messageHandler)}}}};if(!$ADP.Player){$ADP.Player=function(b,a){return this instanceof $ADP.Player?this.init(b,a):new $ADP.Player(b,a)};$ADP.Player.prototype={attempts:0,maxAttempt:50,browserLanguage:undefined,documentCharset:undefined,translation:{de:{adchoices:"Datenschutzinfo",header:'<strong class="adp-header-strong">Informationen zu nutzungsbasierter Online-Werbung</strong><br/>In der vorliegenden Anzeige werden Ihre Nutzungsdaten anonym erhoben bzw. verwendet, um Werbung f&uuml;r Sie zu optimieren. Wenn Sie keine nutzungsbasierte Werbung mehr von den hier gelisteten Anbietern erhalten wollen, k&ouml;nnen Sie die Datenerhebung beim jeweiligen Anbieter direkt deaktivieren. Eine Deaktivierung bedeutet nicht, dass Sie k&uuml;nftig keine Werbung mehr erhalten, sondern, dass die Auslieferung durch den jeweiligen Dienstleister nicht anhand anonym erhobener Nutzungsdaten erfolgt.',footer:'Wenn Sie mehr &uuml;ber nutzungsbasierte Online-Werbung erfahren wollen, klicken Sie <a href="http://www.youronlinechoices.eu/" target="_blank">hier</a>. Dort k&ouml;nnen Sie dar&uuml;ber hinaus auch bei weiteren Anbietern die Erhebung der Nutzungsinformationen deaktivieren bzw. aktivieren und den Status der Aktivierung bei unterschiedlichen Anbietern <a href="http://www.youronlinechoices.eu/" target="_blank">einsehen</a>.'},en:{adchoices:"AdChoices",header:'<strong class="adp-header-strong">Information about Online Behavioural Advertising</strong><br/>In the current ad your usage (behavioural) data are collected anonymously and used to optimize advertising for you. If you do not want to receive any more behavior-based advertising by the vendors listed here, you can &#8220;turn off&#8221;  the collection of data at the providers level directly. &#8220;Turn off&#8221; does not mean that you will not receive any advertisements in the future. It means that the current campaign is not delivered on the basis of behaviour data, collected on an anonymous way.',footer:'If you wish to learn more about online behavioural advertising, click <a href="http://www.youronlinechoices.eu/" target="_blank">here</a>. There you can also &#8220;turn off&#8221;  or &#8220;turn on&#8221; the collection from other providers. Furthermore you can check the status of data collection from different <a href="http://www.youronlinechoices.com/uk/your-ad-choices" target="_blank">providers</a>.'},fr:{adchoices:"Choisir sa pub"},nl:{adchoices:"Info reclamekeuze"},bg:{adchoices:"&#1042;&#1072;&#1096;&#1080;&#1103;&#1090; &#1080;&#1079;&#1073;&#1086;&#1088;"},cs:{adchoices:"Volby reklamy"},da:{adchoices:"Annoncevalg"},fi:{adchoices:"Mainokseni"},el:{adchoices:"&#927;&#953; &#948;&#953;&#945;&#966;&#951;&#956;&#943;&#963;&#949;&#953;&#962; &#956;&#959;&#965;"},it:{adchoices:"Scegli tu!"},nl:{adchoices:"Info"},no:{adchoices:"Annonsevalg"},pl:{adchoices:"Informacja"},ro:{adchoices:"Optiuni"},sk:{adchoices:"Va&#353;a vo&#318;ba"},es:{adchoices:"Gesti&#243;n anuncios"},sv:{adchoices:"Annonsval"}},init:function(b,a){this.id=b;this.domId=a.domId;this.translationFile=a.translation;this.header=a.header;this.footer=a.footer;this.publisherInfo=a.publisherInfo;this.position=a.position||"top-right";this.usePopup=!!a.usePopup;this.renderCloseButton=!!a.renderCloseButton;this.popup=!!a.popup;this.browserLanguage=$ADP.Util.getBrowserLanguage();this.documentCharset=$ADP.Util.getDocumentCharset()},getId:function(){return this.id},getDOMId:function(){return this.domId},getTranslationFile:function(){return $ADP.Registry.translationFile?$ADP.Registry.translationFile:false},getPosition:function(){return this.position||"top-right"},getHeader:function(){return(this.header||this.getText({type:"header"}))},getFooter:function(){return(this.footer||this.getText({type:"footer"}))},getPublisherInfo:function(){return(this.publisherInfo||"")},getPrivacyButtonText:function(){return this.getText({type:"adchoices"})},usePopupForPrivacyInfo:function(){return this.usePopup==false?false:true},renderCloseButtonForPrivacyInfo:function(){return this.renderCloseButton?true:false},hasPrivacyInfo:function(){return Boolean(this.items.length)},getPopup:function(){return this.popup},getPrivacyInfos:function(){return this.items},inject:function(){var e=this.getId();var f=this.getDOMId();var a=this.getPosition();if(!e){return}if(!f){if(window==window.top&&document.body){return}var c=document.createElement("DIV");c.id=f="iframe-button-"+Math.round(Math.random()*9999);document.body.insertBefore(c,document.body.firstChild)}var b=c||document.getElementById(f);if(b){b.innerHTML='<div id="adp-wrapper-'+e+'" class="adp-wrapper adp-'+a+'" style="z-index:99999999;" onmouseover="this.className += \' adp-admarker-hover\';" onmouseout="this.className = this.className.replace(/adp-admarker-hover/, \'\');"><div id="adp-admarker-'+e+'" class="adp-admarker" ><div id="adp-admarker-icon-'+e+'" class="adp-admarker-icon adp-'+a+'" onClick="$ADP.Registry.collectPrivacy('+e+');"></div><div id="adp-admarker-text-'+e+'" class="adp-admarker-text adp-'+a+'"  onClick="$ADP.Registry.collectPrivacy('+e+');">'+this.getPrivacyButtonText()+"</div></div>"}else{if(this.attempts>this.maxAttempts){$ADP.Util.log("Too many attempts for "+e+", "+f);return}else{++this.attempts;var d=this;setTimeout(function(){d.inject()},100)}}},getPanelHTML:function(){var a=this.getId();var h=this.getPosition();var g=this.getHeader();var p=this.getFooter();var n=this.getPublisherInfo();var m=this.getPrivacyInfos();var b=this.usePopupForPrivacyInfo();var r=!b?"$ADP.Registry.playerCmd("+a+",'hidePrivacy');":"window.close();";var d=this.renderCloseButtonForPrivacyInfo();var o="";for(var f=0;f<m.length;f++){var q=m[f];if(f!=0){o+="<br /><br />\n"}try{o+=q.render()}catch(l){}}var j="";j=j.concat('<div class="adp-panel-wrapper">');if(g!=""){j=j.concat('<div class="adp-panel-header">'+g+"</div>")}if(n!=""){j=j.concat('<div class="adp-panel-publisherinfo">'+n+"</div>")}j=j.concat('<div class="adp-panel-info">'+o+"</div>");if(p!=""){j=j.concat('<div class="adp-panel-footer">'+p+"</div>")}j=j.concat("</div>");var c="";if(!b||(b&&d)){c+='<div id="adp-panel-close-'+a+'" class="adp-panel-close" onClick="'+r+'">x</div>'}c+=j;return c},showPrivacy:function(){var h=this.getPosition();var d=this.getId();var e=this.usePopupForPrivacyInfo();function a(){var l=document.getElementById("adp-panel-"+d);if(!l){var m=document.getElementById("adp-wrapper-"+d);if(!m){return}var l=document.createElement("DIV");l.id="adp-panel-"+d;l.className="adp-panel adp-"+h;l.display="block";l.innerHTML=this.getPanelHTML();m.appendChild(l)}else{l.style.display="block"}}if(!e){var c=this.getPopup();if(c){c.close()}a.apply(this)}else{var i=this.getText({type:"adchoices"});var j=document.styleSheets;var b=this.getPopup();if(!b){a.apply(this)}else{var f=b.document;window.popwin=b;f.write('<!doctype html><html><head><meta charset="utf-8" /><title>'+i+"</title>");for(var g in j){if(j[g].href){f.write('<link rel="stylesheet" href="'+j[g].href+'">')}}f.write('</head><body class="adp-popup"><div class="adp-wrapper"><div class="adp-panel">');f.write(this.getPanelHTML());f.write("</div></div></body></html>");f.close();b.focus()}}},hidePrivacy:function(){var b=this.getId();var a=document.getElementById("adp-panel-"+b);if(a){a.style.display="none"}},getText:function(a){if(a.type){if(!(this.browserLanguage=="de"||this.browserLanguage=="en")&&!document.getElementById("adptranslation")&&this.getTranslationFile()){try{var b=document.createElement("script");b.type="text/javascript";b.async=true;b.id="adptranslation";b.src=this.getTranslationFile();b.charset="utf-8";document.getElementsByTagName("head")[0].appendChild(b);$ADP.Util.log("Try to load translation file: "+this.getTranslationFile())}catch(d){$ADP.Util.log("Failed to load translation file: "+d.message)}}var c;if(this.translation[this.browserLanguage]&&this.translation[this.browserLanguage][a.type]){c=this.translation[this.browserLanguage][a.type]}else{if($ADP.Player.adpTranslation&&$ADP.Player.adpTranslation[this.browserLanguage]&&$ADP.Player.adpTranslation[this.browserLanguage][a.type]){c=$ADP.Player.adpTranslation[this.browserLanguage][a.type]}}if(c&&(this.documentCharset=="UTF-8"||/^[\u0000-\u0080]+$/.test(c))){return c}else{return this.translation.en[a.type]}}}}}if(!$ADP.PrivacyInfo){$ADP.PrivacyInfo=function(a){return this instanceof $ADP.PrivacyInfo?this.init(a):new $ADP.PrivacyInfo(a)};$ADP.PrivacyInfo.prototype={init:function(a){this.valid=a.title&&a.linkText&&a.url?true:false;this.title=a.title;this.text=a.text;this.url=a.url;this.linkText=a.linkText;this.usePopup=!!a.usePopup},getTitle:function(){return this.title},getText:function(){return this.text},getURL:function(){return this.url},getLinkText:function(){return this.linkText},isValid:function(){return this.valid?true:false},usePopup:function(){return this.usePopup?true:false},render:function(){var e=$ADP.Util.safeString(this.getTitle());var d=$ADP.Util.safeString(this.getText());var b=$ADP.Util.safeString(this.getLinkText());var a=$ADP.Util.safeString(this.getURL());var c="";if(b){c+=b}if(a){c='<a href="'+a+'" target="_blank">'+c+"</a>"}if(d){c=d+"<br />"+c}if(e){c='<div class="adp-info-header">'+e+"</div>"+c}return c}}}$ADP.Message=$ADP.Message||{types:{nomsg:"NULL",pullOBA:"ADP.Registry.pullOBA",pullOBA_ACK:"ADP.Registry.pullOBA_ACK",unRegOBA:"ADP.Registry.unRegOBA",unRegOBA_ACK:"ADP.Registry.unRegOBA_ACK"},create:function(a,b){var d={type:a,data:b};try{if($ADP.Util.JSON&&typeof $ADP.Util.JSON.stringify=="function"){return $ADP.Util.JSON.stringify(d)}}catch(c){}return'{"type":"NULL"}'},parse:function(a){try{if($ADP.Util.JSON&&typeof $ADP.Util.JSON.parse=="function"){return $ADP.Util.JSON.parse(a)}}catch(b){}return $ADP.Message.create("NULL",{})},send:function(a,b,c){try{if(a&&a.postMessage){var f=$ADP.Message.create(b,c);a.postMessage(f,"*")}}catch(d){}}};$ADP.Util=$ADP.Util||{browserLanguage:null,documentCharset:null,JSON:window.JSON||{stringify:function(d,b){function a(e){var g=new Array(e.length);for(var f=0,h=e.length;f<h;f++){g[f]=c(e[f])}return g}function c(f,e,g){for(e in (g=f==""+{}&&[])&&f){g.push(c(e)+":"+c(f[e]))}return""+f===f?'"'+f.replace(/[\x00-\x19\\]/g,function(h){return"\\x"+h.charCodeAt().toString(16)})+'"':f&&f.length?"["+a(f)+"]":g?"{"+g+"}":f}return c(d)},parse:function(jsonstr){var JSON_object=null;try{JSON_object=!(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(jsonstr.replace(/"(\\.|[^"\\])*"/g,"")))&&eval("("+jsonstr+")")}catch(e){}return JSON_object}},btoa:function(g,f,j,i,h){for(f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=h="";g.charAt(i|0)||(f="=",i%1);h+=f.charAt(63&j>>8-i%1*8)){j=j<<8|g.charCodeAt(i-=-0.75)}return h},atob:function(i,e,j,f,g,h,a){for(g=h=a="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";j=i.charAt(a++);~j&&(f=h%4?f*64+j:j,h++%4)?g+=String.fromCharCode(255&f>>(-2*h&6)):0){j=e.indexOf(j)}return g},log:function(){try{if(window.location&&window.location.search&&window.location.search.match(/adpdebug/)){$ADP.Util.log.history=$ADP.Util.log.history||[];$ADP.Util.log.history.push(arguments);if(typeof console!="undefined"){console.log(Array.prototype.slice.call(arguments))}}}catch(a){}},safeString:function(b){var a=b;a=a.split("<").join("&lt;");a=a.split(">").join("&gt;");return a},createIframeName:function(b){var a="";if(!window.postMessage){a=$ADP.Util.btoa($ADP.Util.JSON.stringify($ADP.Registry.pullById(b)))}return a},getBrowserLanguage:function(){if(!this.browserLanguage){if(navigator.language){this.browserLanguage=navigator.language}else{if(navigator.browserLanguage){this.browserLanguage=navigator.browserLanguage}else{this.browserLanguage="en"}}this.browserLanguage=/[a-z]+/i.exec(this.browserLanguage)[0];$ADP.Util.log("Detected Browser Language is: "+this.browserLanguage)}return this.browserLanguage?this.browserLanguage:"en"},getDocumentCharset:function(){if(!this.documentCharset){if(document.characterSet){this.documentCharset=document.characterSet}else{if(document.charset){this.documentCharset=document.charset}else{if(document.defaultCharset){this.documentCharset=document.defaultCharset}}}$ADP.Util.log("Detected document charset is: "+this.documentCharset)}return this.documentCharset}};$ADP.getVersion=$ADP.getVersion||function(){return{major:2,minor:0,patch:2,stage:"FINAL"}};if(!$ADP.init){$ADP.init=function(){$ADP.Registry.init()};$ADP.init()};
